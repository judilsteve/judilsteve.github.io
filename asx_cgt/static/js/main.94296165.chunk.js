(this["webpackJsonpportfolio-tracker"]=this["webpackJsonpportfolio-tracker"]||[]).push([[0],{160:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),c=n.n(i),l=n(212),o=n(74),s=n(18),u=n(8),j=n(186),d=n(190),b=n(161),h=n(192),O=n(162),f=n(193),v=n(194),x=n(195),g=n(222),p=n(206),m=n(207),y=n(191),C=n(196),S=n(197),w=n(198),k=n(199),P=n(208),A=n(209),I=n(213),U=n(20),M=n.n(U),Y=n(126),D=n(125),F=n(16),N=n(101),T=n(113),E=function(e){Object(Y.a)(n,e);var t=Object(D.a)(n);function n(e,a){var r;Object(N.a)(this,n);var i=window.localStorage.getItem(e),c=null===i?a:JSON.parse(i);return(r=t.call(this,c)).watch((function(t){return window.localStorage.setItem(e,JSON.stringify(t))})),r}return n}(function(){function e(t){Object(N.a)(this,e),this.value=t,this.watchers=[]}return Object(T.a)(e,[{key:"watch",value:function(e){return this.watchers.push(e),this.watchers.length-1}},{key:"removeWatcher",value:function(e){this.watchers.splice(e,1)}},{key:"setValue",value:function(e){this.value=e;var t,n=Object(F.a)(this.watchers);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(a){n.e(a)}finally{n.f()}}}]),e}());function B(e){var t=Object(a.useState)(e.value),n=Object(u.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){var t=e.watch(i);return function(){return e.removeWatcher(t)}}),[e]),[r,function(t){return e.setValue(t)}]}var L=new E("parcels",[]),$=new E("adjustments",[]),J=new E("sales",[]),z=n(215),X=n(219);function G(e,t,n,a){switch(e.type){case"ACQUISITION":var r=(e.units*e.unitPrice+e.brokerage)/e.units;t[e.id]={id:e.id,date:e.date,memo:e.memo,asxCode:e.asxCode,remainingUnits:e.units,perUnitCostBase:r},null===a||void 0===a||a.push({parcelId:e.id,eventId:e.id,date:e.date,log:"Acquired Parcel ".concat(e.id," with initial cost base of $").concat(r.toFixed(4),"/u.")});break;case"ADJUSTMENT":var i,c=0,l=Object(F.a)(e.applicableParcelIds);try{for(l.s();!(i=l.n()).done;){var o=i.value,s=t[o];if(!s||s.asxCode!==e.asxCode||s.remainingUnits<=0){if(n)throw new Error("Adjustment ".concat(e.id," was applicable to invalid parcel ").concat(o.toFixed(4)))}else c+=s.remainingUnits}}catch(g){l.e(g)}finally{l.f()}var u,j=Object(F.a)(e.applicableParcelIds);try{for(j.s();!(u=j.n()).done;){var d=u.value,b=t[d];if(b){var h=b.remainingUnits/c*100;b.perUnitCostBase+=e.netAmount/c,null===a||void 0===a||a.push({parcelId:d,eventId:e.id,date:e.date,log:"Applied ".concat(h.toFixed(2),"% of a $").concat(e.netAmount," adjustment. New cost base: $").concat(b.perUnitCostBase.toFixed(4),"/u.")})}}}catch(g){j.e(g)}finally{j.f()}break;case"SALE":var O,f=Object(F.a)(e.applicableParcels);try{for(f.s();!(O=f.n()).done;){var v=O.value,x=t[v.id];if(x)x.remainingUnits-=v.unitsSold,null===a||void 0===a||a.push({parcelId:x.id,eventId:e.id,date:e.date,log:"Sold ".concat(v.unitsSold," units. Remaining units: ").concat(x.remainingUnits)});else if(n)throw new Error("Sale ".concat(e.id," was applicable to non-existent parcel ").concat(v.id))}}catch(g){f.e(g)}finally{f.f()}break;default:throw new Error("Unrecognised event type ".concat(e.type))}}function W(e,t,n,a){var r,i={},c=Object(F.a)(e);try{for(c.s();!(r=c.n()).done;){var l=r.value;if(l.id!==a){if(null!==t&&l.date>t)break;G(l,i,n)}}}catch(o){c.e(o)}finally{c.f()}return i}function _(e,t,n,r){return Object(a.useMemo)((function(){var a=W(e,t,n,r);return Object.values(a)}),[e,t,n,r])}var R=n(49);function V(){var e=B(L),t=Object(u.a)(e,1)[0],n=B($),r=Object(u.a)(n,1)[0],i=B(J),c=Object(u.a)(i,1)[0];return Object(a.useMemo)((function(){return Object(z.a)([].concat(Object(s.a)(t.map((function(e){return Object(R.a)({type:"ACQUISITION"},e)}))),Object(s.a)(r.map((function(e){return Object(R.a)({type:"ADJUSTMENT"},e)}))),Object(s.a)(c.map((function(e){return Object(R.a)({type:"SALE"},e)})))),[function(e){return e.date},function(e){return"ACQUISITION"===e.type?1:"ADJUSTMENT"===e.type&&e.netAmount>0?2:"SALE"===e.type?3:4}])}),[t,r,c])}var q=n(1);function H(){var e=B(L),t=Object(u.a)(e,2),n=t[0],r=t[1],i=Object(a.useMemo)((function(){return Object(z.a)(n,(function(e){return e.date}))}),[n]),c=Object(a.useMemo)((function(){var e,t=null===(e=Object(X.a)(n,(function(e){return e.id})))||void 0===e?void 0:e.id;if(void 0===t)return"A";for(var a="A".charCodeAt(0)-1,r=0,i=0,c=t.length-1;c>=0;c--)r+=(t.charCodeAt(c)-a)*Math.pow(26,i++);for(var l=r+1,o="";l;){var s=(l-1)%26;o=String.fromCharCode(65+s)+o,l=Math.floor((l-s)/26)}return o}),[n]),l=Object(a.useState)(!1),o=Object(u.a)(l,2),g=o[0],p=o[1],m=g?Object(q.jsx)(K,{id:c,cancel:function(){return p(!1)},save:function(e){r([].concat(Object(s.a)(n),[e])),p(!1)}}):Object(q.jsx)(j.a,{children:Object(q.jsx)(d.a,{align:"right",colSpan:9,children:Object(q.jsx)(b.a,{onClick:function(){return p(!0)},children:Object(q.jsx)(y.a,{})})})}),P=Object(a.useState)([]),A=Object(u.a)(P,2),I=A[0],U=A[1],Y=function(e){return U(I.filter((function(t){return t!==e})))},D=function(e){r([].concat(Object(s.a)(n.filter((function(t){return t.id!==e.id}))),[e])),Y(e.id)},F=Object(a.useState)([]),N=Object(u.a)(F,2),T=N[0],E=N[1];return Object(q.jsx)(h.a,{component:O.a,children:Object(q.jsxs)(f.a,{style:{minWidth:650},size:"small",children:[Object(q.jsx)(v.a,{children:Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{children:"ID"}),Object(q.jsx)(d.a,{align:"right",children:"Date Acquired"}),Object(q.jsx)(d.a,{align:"right",children:"ASX Code"}),Object(q.jsx)(d.a,{align:"right",children:"Parcel Type"}),Object(q.jsx)(d.a,{align:"right",children:"Memo"}),Object(q.jsx)(d.a,{align:"right",children:"Units"}),Object(q.jsx)(d.a,{align:"right",children:"Unit Price ($/u)"}),Object(q.jsx)(d.a,{align:"right",children:"Brokerage ($)"}),Object(q.jsx)(d.a,{align:"right",children:"Actions"})]})}),Object(q.jsxs)(x.a,{children:[i.map((function(e){return I.includes(e.id)?Object(q.jsx)(K,{id:e.id,parcel:e,cancel:function(){return Y(e.id)},save:D},e.id):Object(q.jsxs)(a.Fragment,{children:[Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{component:"th",scope:"row",children:e.id}),Object(q.jsx)(d.a,{align:"right",children:M()(e.date).format("YYYY-MM-DD")}),Object(q.jsx)(d.a,{align:"right",children:e.asxCode}),Object(q.jsx)(d.a,{align:"right",children:e.isDrp?"Dividend Reinvestment":"Purchase"}),Object(q.jsx)(d.a,{align:"right",children:e.memo}),Object(q.jsx)(d.a,{align:"right",children:e.units}),Object(q.jsx)(d.a,{align:"right",children:e.unitPrice}),Object(q.jsx)(d.a,{align:"right",children:e.brokerage}),Object(q.jsxs)(d.a,{align:"right",children:[Object(q.jsx)(b.a,{size:"small",onClick:function(){return t=e.id,T.includes(t)?E(T.filter((function(e){return e!==t}))):E([T].concat(Object(s.a)(t)));var t},children:T.includes(e.id)?Object(q.jsx)(C.a,{}):Object(q.jsx)(S.a,{})}),Object(q.jsx)(b.a,{size:"small",onClick:function(){return t=e.id,U([].concat(Object(s.a)(I),[t]));var t},children:Object(q.jsx)(w.a,{})}),Object(q.jsx)(b.a,{size:"small",onClick:function(){return r(n.filter((function(t){return t.id!==e.id})))},children:Object(q.jsx)(k.a,{})})]})]},e.id),T.includes(e.id)&&Object(q.jsx)(Q,{parcelId:e.id})]},e.id)})),m]})]})})}function Q(e){var t=e.parcelId,n=V(),r=Object(a.useMemo)((function(){return function(e){var t,n={},a=[],r=Object(F.a)(e);try{for(r.s();!(t=r.n()).done;)G(t.value,n,!1,a)}catch(i){r.e(i)}finally{r.f()}return a}(n).filter((function(e){return e.parcelId===t}))}),[n,t]);return Object(q.jsx)(q.Fragment,{children:r.map((function(e){return Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(o.a,{variant:"body2",color:"primary",children:M()(e.date).format("YYYY-MM-DD")})}),Object(q.jsx)(d.a,{colSpan:7,align:"right",children:Object(q.jsx)(o.a,{variant:"body2",color:"primary",children:e.log})},e.eventId)]})}))})}function K(e){var t=e.id,n=e.save,r=e.cancel,i=e.parcel,c=Object(a.useState)(null),l=Object(u.a)(c,2),o=l[0],s=l[1],h=Object(a.useState)(""),O=Object(u.a)(h,2),f=O[0],v=O[1],x=Object(a.useState)(!1),y=Object(u.a)(x,2),C=y[0],S=y[1],w=Object(a.useState)(""),k=Object(u.a)(w,2),U=k[0],M=k[1],Y=Object(a.useState)(""),D=Object(u.a)(Y,2),F=D[0],N=D[1],T=Object(a.useState)(""),E=Object(u.a)(T,2),B=E[0],L=E[1],$=Object(a.useState)(""),J=Object(u.a)($,2),z=J[0],X=J[1];Object(a.useEffect)((function(){var e,t,n,a,r,c,l;s(null!==(e=null===i||void 0===i?void 0:i.date)&&void 0!==e?e:null),v(null!==(t=null===i||void 0===i?void 0:i.asxCode)&&void 0!==t?t:""),S(null!==(n=null===i||void 0===i?void 0:i.isDrp)&&void 0!==n&&n),M(null!==(a=null===i||void 0===i?void 0:i.memo)&&void 0!==a?a:""),N(null!==(r=null===i||void 0===i?void 0:i.units.toString())&&void 0!==r?r:""),L(null!==(c=null===i||void 0===i?void 0:i.unitPrice.toString())&&void 0!==c?c:""),X(null!==(l=null===i||void 0===i?void 0:i.brokerage.toString())&&void 0!==l?l:"")}),[i]);var G=F&&!isNaN(parseFloat(F))&&parseInt(F)===parseFloat(F),W=B&&!isNaN(parseFloat(B)),_=C||z&&!isNaN(parseFloat(z)),R=o&&f&&G&&W&&_;return Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{component:"th",scope:"row",children:t}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(I.a,{disableToolbar:!0,variant:"inline",format:"YYYY-MM-DD",label:"Date",value:o,error:!o,onChange:function(e){return s(e.toJSON())}})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{value:f,onChange:function(e){return v(e.target.value)},error:!f,label:"ASX Code"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(p.a,{control:Object(q.jsx)(m.a,{value:C,onChange:function(){return S(!C)}}),label:"Dividend Reinvestment"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{value:U,onChange:function(e){return M(e.target.value)},label:"Memo"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",value:F,onChange:function(e){return N(e.target.value)},error:!G,label:"Units"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",value:B,onChange:function(e){return L(e.target.value)},error:!W,label:"Unit Price ($/u)"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",disabled:C,value:C?"0.00":z,onChange:function(e){return X(e.target.value)},error:!C&&!_,label:"Brokerage ($)"})}),Object(q.jsxs)(d.a,{align:"right",children:[Object(q.jsx)(b.a,{onClick:function(){return n({id:t,date:o,asxCode:f,isDrp:C,memo:U,units:parseInt(F),unitPrice:parseFloat(B),brokerage:C?0:parseFloat(z)})},disabled:!R,children:Object(q.jsx)(P.a,{})}),Object(q.jsx)(b.a,{onClick:r,children:Object(q.jsx)(A.a,{})})]})]})}var Z=n(220),ee=n(225),te=n(218),ne=n(211),ae=n(210),re=n(205),ie=n(224),ce=n(216);function le(e){var t=e.disabled,n=e.error,a=e.value,r=e.onChange,i=e.children,c=e.renderValue,l=e.multiple,o=e.id,s=e.label;return Object(q.jsxs)(re.a,{fullWidth:!0,children:[Object(q.jsx)(ie.a,{id:o,children:s}),Object(q.jsx)(ce.a,{MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null},disabled:t,labelId:o,error:n,multiple:l,fullWidth:!0,value:a,onChange:r,renderValue:c,children:i})]})}var oe=n(217);function se(){var e=B($),t=Object(u.a)(e,2),n=t[0],r=t[1],i=Object(a.useMemo)((function(){return Object(z.a)(n,(function(e){return e.date}))}),[n]),c=Object(a.useState)(!1),l=Object(u.a)(c,2),o=l[0],g=l[1],p=o?Object(q.jsx)(ue,{cancel:function(){return g(!1)},save:function(e){r([].concat(Object(s.a)(n),[e])),g(!1)}}):Object(q.jsx)(j.a,{children:Object(q.jsx)(d.a,{align:"right",colSpan:7,children:Object(q.jsx)(b.a,{onClick:function(){return g(!0)},children:Object(q.jsx)(y.a,{})})})}),m=Object(a.useState)([]),C=Object(u.a)(m,2),S=C[0],P=C[1],A=function(e){return P(S.filter((function(t){return t!==e})))},I=function(e){r([].concat(Object(s.a)(n.filter((function(t){return t.id!==e.id}))),[e])),A(e.id)},U=V(),Y=Object(a.useMemo)((function(){var e,t={},a=Object(F.a)(n);try{for(a.s();!(e=a.n()).done;){var r,i=e.value,c=[],l=W(U,i.date,!1),o=Object(F.a)(i.applicableParcelIds);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=l[s];void 0!==u?u.asxCode!==i.asxCode?c.push("Parcel ".concat(s," has the wrong ASX Code.")):u.remainingUnits<=0&&c.push("Parcel ".concat(s," was entirely sold before the adjustment date.")):c.push("Parcel ".concat(s," did not exist at the adjustment date."))}}catch(j){o.e(j)}finally{o.f()}t[i.id]=c}}catch(j){a.e(j)}finally{a.f()}return t}),[U,n]);return Object(q.jsx)(h.a,{component:O.a,children:Object(q.jsxs)(f.a,{style:{minWidth:650},size:"small",children:[Object(q.jsx)(v.a,{children:Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:"Date"}),Object(q.jsx)(d.a,{align:"right",children:"ASX Code"}),Object(q.jsx)(d.a,{align:"right",children:"Applicable Parcels"}),Object(q.jsx)(d.a,{align:"right",children:"Memo"}),Object(q.jsx)(d.a,{align:"right",children:"Net Amount ($)"}),Object(q.jsx)(d.a,{align:"right",children:"Actions"})]})}),Object(q.jsxs)(x.a,{children:[i.map((function(e){return S.includes(e.id)?Object(q.jsx)(ue,{id:e.id,adjustment:e,cancel:function(){return A(e.id)},save:I},e.id):Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{children:Y[e.id].length?Y[e.id].map((function(e){return Object(q.jsx)(Z.a,{title:e,children:Object(q.jsx)(ae.a,{color:"error"})},e)})):Object(q.jsx)(q.Fragment,{})}),Object(q.jsx)(d.a,{align:"right",children:M()(e.date).format("YYYY-MM-DD")}),Object(q.jsx)(d.a,{align:"right",children:e.asxCode}),Object(q.jsx)(d.a,{align:"right",children:e.applicableParcelIds.join(", ")}),Object(q.jsx)(d.a,{align:"right",children:e.memo}),Object(q.jsx)(d.a,{align:"right",children:e.netAmount}),Object(q.jsxs)(d.a,{align:"right",children:[Object(q.jsx)(b.a,{size:"small",onClick:function(){return t=e.id,P([].concat(Object(s.a)(S),[t]));var t},children:Object(q.jsx)(w.a,{})}),Object(q.jsx)(b.a,{size:"small",onClick:function(){return r(n.filter((function(t){return t.id!==e.id})))},children:Object(q.jsx)(k.a,{})})]})]},e.id)})),p]})]})})}function ue(e){var t=e.id,n=e.save,r=e.cancel,i=e.adjustment,c=Object(a.useState)(null),l=Object(u.a)(c,2),o=l[0],s=l[1],h=Object(a.useState)(null),O=Object(u.a)(h,2),f=O[0],v=O[1],x=Object(a.useState)([]),p=Object(u.a)(x,2),m=p[0],y=p[1],C=Object(a.useState)(""),S=Object(u.a)(C,2),w=S[0],k=S[1],U=Object(a.useState)(""),Y=Object(u.a)(U,2),D=Y[0],F=Y[1];Object(a.useEffect)((function(){var e,t,n,a,r;s(null!==(e=null===i||void 0===i?void 0:i.date)&&void 0!==e?e:null),v(null!==(t=null===i||void 0===i?void 0:i.asxCode)&&void 0!==t?t:null),y(null!==(n=null===i||void 0===i?void 0:i.applicableParcelIds)&&void 0!==n?n:[]),k(null!==(a=null===i||void 0===i?void 0:i.memo)&&void 0!==a?a:""),F(null!==(r=null===i||void 0===i?void 0:i.netAmount.toString())&&void 0!==r?r:"")}),[i]);var N=D&&!isNaN(parseFloat(D)),T=o&&m.length&&N,E=_(V(),o,!1),B=Object(a.useMemo)((function(){return E.filter((function(e){return!f||e.asxCode===f}))}),[E,f]);return Object(a.useEffect)((function(){y((function(e){return e.filter((function(e){return B.find((function(t){return t.id===e&&(!f||t.asxCode===f)}))}))}))}),[B,f]),Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(I.a,{disableToolbar:!0,variant:"inline",format:"YYYY-MM-DD",label:"Date",value:o,error:!o,onChange:function(e){return s(e.toJSON())}})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{value:f,onChange:function(e){return v(e.target.value)},label:"ASX Code"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(le,{disabled:!o||!B.length,id:"applicable-parcel-select",label:"Applicable Parcels",error:!m.length,multiple:!0,value:m,onChange:function(e){return y(e.target.value)},renderValue:function(e){return e.join(", ")},children:B.map((function(e){return Object(q.jsxs)(ee.a,{value:e.id,children:[Object(q.jsx)(te.a,{checked:m.includes(e.id)}),Object(q.jsx)(ne.a,{primary:"".concat(e.id).concat(e.memo?": "+e.memo:""),secondary:"".concat(e.remainingUnits,"x ").concat(e.asxCode,", acquired ").concat(M()(e.date).format("YYYY-MM-DD"))})]},e.id)}))})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{value:w,onChange:function(e){return k(e.target.value)},label:"Memo"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",value:D,onChange:function(e){return F(e.target.value)},error:!N,label:"Net Amount ($)"})}),Object(q.jsxs)(d.a,{align:"right",children:[Object(q.jsx)(b.a,{onClick:function(){return n({id:null!==t&&void 0!==t?t:Object(oe.a)(),date:o,asxCode:f,applicableParcelIds:m,memo:w,netAmount:parseFloat(D)})},disabled:!T,children:Object(q.jsx)(P.a,{})}),Object(q.jsx)(b.a,{onClick:r,children:Object(q.jsx)(A.a,{})})]})]})}var je=n(103),de=n.n(je),be=n(121),he=n(201);function Oe(){var e=B(L),t=Object(u.a)(e,2),n=t[0],r=t[1],i=B($),c=Object(u.a)(i,2),l=c[0],s=c[1],j=B(J),d=Object(u.a)(j,2),b=d[0],h=d[1],O=Object(a.useState)(null),f=Object(u.a)(O,2),v=f[0],x=f[1],g=Object(a.useState)(null),p=Object(u.a)(g,2),m=p[0],y=p[1],C=function(){var e=Object(be.a)(de.a.mark((function e(t){var n;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm("WARNING: Importing this file will completely and irreversibly replace any data currently entered. Continue?")){e.next=2;break}return e.abrupt("return");case 2:return x(null),y(null),e.prev=4,e.t0=JSON,e.next=8,t[0].text();case 8:e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),e.next=16;break;case 12:throw e.prev=12,e.t2=e.catch(4),x("File was not valid JSON. Ensure that you have selected the correct file and try again."),e.t2;case 16:if(n.parcels&&n.adjustments&&n.sales){e.next=19;break}return x("File appears malformed. Ensure that you have selected the correct file and try again."),e.abrupt("return");case 19:r(n.parcels),s(n.adjustments),h(n.sales),y("Import successful"),setTimeout((function(){return y(null)}),3e4);case 24:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}(),S=Object(a.useRef)(null);return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("input",{ref:S,onChange:function(e){return C(e.target.files)},accept:"application/json",style:{display:"none"},id:"import-file-input",type:"file"}),Object(q.jsx)("label",{htmlFor:"import-file-input",children:Object(q.jsx)(he.a,{onClick:function(){var e;return null===(e=S.current)||void 0===e?void 0:e.click()},variant:"contained",color:"primary",children:"Import Holdings"})}),Object(q.jsx)(he.a,{onClick:function(){var e=new Blob([JSON.stringify({parcels:n,adjustments:l,sales:b})]),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t;var r=M()();a.download="Holdings_".concat(r.format("YYYY-MM-DD_Thh-mm-ss"),".json"),document.body.appendChild(a),a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(a)},style:{margin:10},variant:"contained",color:"primary",children:"Export Holdings"}),!v&&!m&&Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{color:"textSecondary",variant:"body2",children:"NOTE: Importing holdings will completely and irreversibly replace any data currently entered"})]}),v&&Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{color:"error",variant:"body2",children:v})]}),m&&Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{color:"textSecondary",variant:"body2",children:m})]})]})}function fe(e,t,n){return n>0&&M()(e).diff(M()(t),"year",!0)>1&&(n/=2),n}function ve(e){var t,n=0,a=0,r=Object(F.a)(e.applicableParcels);try{for(r.s();!(t=r.n()).done;){a+=t.value.unitsSold}}catch(s){r.e(s)}finally{r.f()}var i,c=Object(F.a)(e.applicableParcels);try{for(c.s();!(i=c.n()).done;){var l=i.value,o=e.unitPrice*l.unitsSold;o-=l.unitsSold*l.perUnitCostBase,o-=e.brokerage*(l.unitsSold/a),n+=fe(e.date,l.date,o)}}catch(s){c.e(s)}finally{c.f()}return n}function xe(){var e=B(J),t=Object(u.a)(e,2),n=t[0],r=t[1],i=V(),c=Object(a.useMemo)((function(){var e,t=[],n={},a={},r=Object(F.a)(i);try{for(r.s();!(e=r.n()).done;){var c=e.value;if("SALE"===c.type){var l,o={errors:[],applicableParcels:[]},s=Object(F.a)(c.applicableParcels);try{for(s.s();!(l=s.n()).done;){var u,j=l.value,d=a[j.id];d?d.asxCode!==c.asxCode?o.errors.push("Parcel ".concat(j.id," has the wrong ASX Code")):d.remainingUnits<j.unitsSold&&o.errors.push("Parcel ".concat(j.id," does not have enough remaining units to complete sale")):o.errors.push("Parcel ".concat(j.id," did not exist at the sale date")),o.applicableParcels.push(Object(R.a)(Object(R.a)({},j),{},{unitsAvailable:null!==(u=null===d||void 0===d?void 0:d.remainingUnits)&&void 0!==u?u:"??"}))}}catch(b){s.e(b)}finally{s.f()}o.cgtLiability=o.errors.length?null:ve({unitPrice:c.unitPrice,date:c.date,brokerage:c.brokerage,applicableParcels:o.applicableParcels.map((function(e){return{date:a[e.id].date,perUnitCostBase:a[e.id].perUnitCostBase,unitsSold:e.unitsSold}}))}),t.push(c),n[c.id]=o}G(c,a,!1)}}catch(b){r.e(b)}finally{r.f()}return{orderedSales:t,saleDataLookup:n}}),[i]),l=c.orderedSales,g=c.saleDataLookup,p=Object(a.useState)(!1),m=Object(u.a)(p,2),C=m[0],S=m[1],P=C?Object(q.jsx)(ge,{cancel:function(){return S(!1)},save:function(e){r([].concat(Object(s.a)(n),[e])),S(!1)},allEventsOrdered:i}):Object(q.jsx)(j.a,{children:Object(q.jsx)(d.a,{align:"right",colSpan:9,children:Object(q.jsx)(b.a,{onClick:function(){return S(!0)},children:Object(q.jsx)(y.a,{})})})}),A=Object(a.useState)([]),I=Object(u.a)(A,2),U=I[0],Y=I[1],D=function(e){return Y(U.filter((function(t){return t!==e})))},N=function(e){r([].concat(Object(s.a)(n.filter((function(t){return t.id!==e.id}))),[e])),D(e.id)};return Object(q.jsx)(h.a,{component:O.a,children:Object(q.jsxs)(f.a,{style:{minWidth:650},size:"small",children:[Object(q.jsx)(v.a,{children:Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:"Date"}),Object(q.jsx)(d.a,{align:"right",children:"ASX Code"}),Object(q.jsx)(d.a,{align:"right",children:"Applicable Parcels"}),Object(q.jsx)(d.a,{align:"right",children:"Memo"}),Object(q.jsx)(d.a,{align:"right",children:"Unit Price ($/u)"}),Object(q.jsx)(d.a,{align:"right",children:"Brokerage ($)"}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(o.a,{variant:"body2",color:"primary",children:"CGT Liability ($)"})}),Object(q.jsx)(d.a,{align:"right",children:"Actions"})]})}),Object(q.jsxs)(x.a,{children:[l.map((function(e){var t,a;return U.includes(e.id)?Object(q.jsx)(ge,{id:e.id,sale:e,cancel:function(){return D(e.id)},save:N,allEventsOrdered:i},e.id):Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{children:g[e.id].errors.length?g[e.id].errors.map((function(e){return Object(q.jsx)(Z.a,{title:e,children:Object(q.jsx)(ae.a,{color:"error"})},e)})):Object(q.jsx)(q.Fragment,{})}),Object(q.jsx)(d.a,{align:"right",children:M()(e.date).format("YYYY-MM-DD")}),Object(q.jsx)(d.a,{align:"right",children:e.asxCode}),Object(q.jsx)(d.a,{align:"right",children:g[e.id].applicableParcels.map((function(e){return"".concat(e.id," (").concat(e.unitsSold,"/").concat(e.unitsAvailable,")")})).join(", ")}),Object(q.jsx)(d.a,{align:"right",children:e.memo}),Object(q.jsx)(d.a,{align:"right",children:e.unitPrice}),Object(q.jsx)(d.a,{align:"right",children:e.brokerage}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(o.a,{variant:"body2",color:"primary",children:null!==(t=null===(a=g[e.id].cgtLiability)||void 0===a?void 0:a.toFixed(4))&&void 0!==t?t:"??"})}),Object(q.jsxs)(d.a,{align:"right",children:[Object(q.jsx)(b.a,{size:"small",onClick:function(){return t=e.id,Y([].concat(Object(s.a)(U),[t]));var t},children:Object(q.jsx)(w.a,{})}),Object(q.jsx)(b.a,{size:"small",onClick:function(){return r(n.filter((function(t){return t.id!==e.id})))},children:Object(q.jsx)(k.a,{})})]})]},e.id)})),P]})]})})}function ge(e){var t,n,r=e.id,i=e.save,c=e.cancel,l=e.sale,s=e.allEventsOrdered,h=Object(a.useState)(null),O=Object(u.a)(h,2),f=O[0],v=O[1],x=Object(a.useState)(""),p=Object(u.a)(x,2),m=p[0],y=p[1],C=Object(a.useState)([]),S=Object(u.a)(C,2),w=S[0],k=S[1],U=Object(a.useState)(""),M=Object(u.a)(U,2),Y=M[0],D=M[1],N=Object(a.useState)(""),T=Object(u.a)(N,2),E=T[0],B=T[1],L=Object(a.useState)(""),$=Object(u.a)(L,2),J=$[0],X=$[1],G=Object(a.useState)({}),W=Object(u.a)(G,2),V=W[0],H=W[1];Object(a.useEffect)((function(){var e,t,n,a,r,i,c;v(null!==(e=null===l||void 0===l?void 0:l.date)&&void 0!==e?e:null),y(null!==(t=null===l||void 0===l?void 0:l.asxCode)&&void 0!==t?t:""),k(null!==(n=null===l||void 0===l?void 0:l.applicableParcels.map((function(e){return e.id})))&&void 0!==n?n:[]),D(null!==(a=null===l||void 0===l?void 0:l.memo)&&void 0!==a?a:""),B(null!==(r=null===l||void 0===l?void 0:l.unitPrice.toString())&&void 0!==r?r:""),X(null!==(i=null===l||void 0===l?void 0:l.brokerage.toString())&&void 0!==i?i:"");var o,s={},u=Object(F.a)(null!==(c=null===l||void 0===l?void 0:l.applicableParcels)&&void 0!==c?c:[]);try{for(u.s();!(o=u.n()).done;){var j=o.value;s[j.id]=j.unitsSold.toString()}}catch(d){u.e(d)}finally{u.f()}H(s)}),[l]);var Q=_(s,f,!1,r),K=Object(a.useMemo)((function(){return m?Q.filter((function(e){return e.asxCode===m})):Q}),[Q,m]),Z=Object(a.useMemo)((function(){var e,t={},n=Object(F.a)(K);try{for(n.s();!(e=n.n()).done;){var a=e.value;t[a.id]=a}}catch(r){n.e(r)}finally{n.f()}return t}),[K]),ae=!w.find((function(e){return!pe(Z[e],V[e])})),re=E&&!isNaN(parseFloat(E)),ie=J&&!isNaN(parseFloat(J)),ce=f&&w.length&&re&&ie&&m&&ae,se=re&&f&&ae,ue=Object(a.useMemo)((function(){var e={};if(!se)return{};var t,n=parseFloat(E),a=Object(F.a)(K);try{for(a.s();!(t=a.n()).done;){var r=t.value,i=n-r.perUnitCostBase;e[r.id]=fe(f,r.date,i)}}catch(c){a.e(c)}finally{a.f()}return e}),[E,f,K,se]),je=Object(a.useMemo)((function(){return Object(z.a)(K,(function(e){return ue[e.id]}))}),[K,ue]),de=null;se&&ie&&(de=ve({unitPrice:parseFloat(E),date:f,brokerage:parseFloat(J),applicableParcels:w.map((function(e){return{date:Z[e].date,perUnitCostBase:Z[e].perUnitCostBase,unitsSold:parseInt(V[e])}}))}));var be=Object(a.useCallback)((function(e){H((function(t){var n,a={},r=Object(F.a)(e);try{for(r.s();!(n=r.n()).done;){var i,c=n.value;a[c]=null!==(i=t[c])&&void 0!==i?i:Z[c].remainingUnits}}catch(l){r.e(l)}finally{r.f()}return a}))}),[Z]);Object(a.useEffect)((function(){k((function(e){var t=e.filter((function(e){return je.find((function(t){return t.id===e}))}));return be(t),t}))}),[je,be]);return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(I.a,{disableToolbar:!0,variant:"inline",format:"YYYY-MM-DD",label:"Date",value:f,error:!f,onChange:function(e){return v(e.toJSON())}})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{value:m,onChange:function(e){return y(e.target.value)},label:"ASX Code",error:!m})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(le,{disabled:!f||!je.length||!m,labelId:"applicable-parcel-select",label:"Applicable Parcels",error:!w.length,multiple:!0,fullWidth:!0,value:w,onChange:function(e){return t=e.target.value,k(t),void be(t);var t},renderValue:function(e){return e.map((function(e){return e})).join(", ")},children:je.map((function(e){var t,n;return Object(q.jsxs)(ee.a,{value:e.id,children:[Object(q.jsx)(te.a,{checked:!!w.includes(e.id)}),Object(q.jsx)(ne.a,{primary:"".concat(e.id).concat(e.memo?": "+e.memo:""),secondary:"".concat(e.remainingUnits," available, $").concat(null!==(t=null===(n=ue[e.id])||void 0===n?void 0:n.toFixed(4))&&void 0!==t?t:"??","/u CGT")})]},e.id)}))})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{value:Y,onChange:function(e){return D(e.target.value)},label:"Memo"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",value:E,onChange:function(e){return B(e.target.value)},error:!re,label:"Unit Price ($/u)"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",value:J,onChange:function(e){return X(e.target.value)},error:!ie,label:"Brokerage ($)"})}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsxs)(o.a,{variant:"body2",color:"primary",children:["Total: ",null!==(t=null===(n=de)||void 0===n?void 0:n.toFixed(4))&&void 0!==t?t:"??"]})}),Object(q.jsxs)(d.a,{align:"right",rowSpan:w.length+1,children:[Object(q.jsx)(b.a,{onClick:function(){return i({id:null!==r&&void 0!==r?r:Object(oe.a)(),date:f,asxCode:m,applicableParcels:w.map((function(e){return{id:e,unitsSold:parseInt(V[e])}})),memo:Y,unitPrice:parseFloat(E),brokerage:parseFloat(J)})},disabled:!ce,children:Object(q.jsx)(P.a,{})}),Object(q.jsx)(b.a,{onClick:c,children:Object(q.jsx)(A.a,{})})]})]}),w.map((function(e){return Object(q.jsx)(me,{parcel:Z[e],perUnitCgtLiability:ue[e],unitsSold:V[e],setUnitsSold:function(t){return function(e,t){var n=Object(R.a)({},V);n[e]=t,H(n)}(e,t)}},e)}))]})}function pe(e,t){var n;if(!t)return!1;var a=parseFloat(t);if(isNaN(a))return!1;var r=parseInt(t);return r===a&&(!(r>(null!==(n=null===e||void 0===e?void 0:e.remainingUnits)&&void 0!==n?n:0))&&!(r<=0))}function me(e){var t,n,a,r=e.parcel,i=e.perUnitCgtLiability,c=e.unitsSold,l=e.setUnitsSold,s=pe(r,c),u=void 0!==i&&s?(i*parseInt(c)).toFixed(4):"??";return Object(q.jsxs)(j.a,{children:[Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsx)(g.a,{type:"number",value:c,onChange:function(e){return l(e.target.value)},error:!s,label:"Units of ".concat(null!==(t=null===r||void 0===r?void 0:r.id)&&void 0!==t?t:"??"),helperText:"".concat(null!==(n=null===r||void 0===r?void 0:r.remainingUnits)&&void 0!==n?n:"??"," available")})}),Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{}),Object(q.jsx)(d.a,{align:"right",children:Object(q.jsxs)(o.a,{variant:"body2",color:"primary",children:[null!==(a=null===r||void 0===r?void 0:r.id)&&void 0!==a?a:"??",": ",u]})})]})}function ye(){return Object(q.jsxs)("form",{action:"https://www.paypal.com/donate",method:"post",target:"_top",children:[Object(q.jsx)("input",{type:"hidden",name:"business",value:"VT6UPHJXTK3N2"}),Object(q.jsx)("input",{type:"hidden",name:"no_recurring",value:"1"}),Object(q.jsx)("input",{type:"hidden",name:"item_name",value:"CGT Calculator Thankyou"}),Object(q.jsx)("input",{type:"hidden",name:"currency_code",value:"AUD"}),Object(q.jsx)("input",{type:"image",src:"https://www.paypalobjects.com/en_AU/i/btn/btn_donate_LG.gif",border:"0",name:"submit",title:"PayPal - The safer, easier way to pay online!",alt:"Donate with PayPal button"}),Object(q.jsx)("img",{alt:"",border:"0",src:"https://www.paypal.com/en_AU/i/scr/pixel.gif",width:"1",height:"1"})]})}var Ce=function(){var e="https://github.com/judilsteve/asx-cgt-calculator-optimiser";return Object(q.jsxs)(l.a,{maxWidth:"xl",children:[Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h2",children:"ASX CGT Calculator/Optimiser"}),Object(q.jsx)("br",{}),Object(q.jsxs)(o.a,{variant:"h6",children:["This is a simple calculator that helps with record-keeping for your ASX holdings, and calculation of CGT when selling.",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),"All care has been taken to ensure that the calculations made here are correct and that they conform to ATO requirements (as at 2021-07-10). I trust this calculator enough to use it for record-keeping and CGT calculations of my own portfolio. However, I make no guarantee that the calculator is free from defects and accept no liability for any consequences incurred by you of issues herein. Always check any values calculated here against your own calculations.",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),"If you find any issues with the calculator, please raise them ",Object(q.jsx)("a",{href:"".concat(e,"/issues"),children:"here"}),".",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),"If you find this calculator useful, and you want to show your appreciation, you can use the donation link below to shout me a coffee.",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),Object(q.jsx)(ye,{}),Object(q.jsx)("br",{}),"This calculator is a Single Page Application, or SPA. This means you can save the entire application to your computer right now (press Ctrl+S on your keyboard) so that you still have access too the calculator even if this website disappears from the internet.",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),"This calculator is also free software licensed under the ",Object(q.jsx)("a",{href:"".concat(e,"/blob/master/COPYING.md"),children:"Affero GPL"}),". You may view the source code ",Object(q.jsx)("a",{href:e,children:"here"}),". If you wish to use the source code as a basis for your own work, you may do so, but you must adhere to the terms of the original license if you distribute your work.",Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),"Portfolio data is auto-saved to your browser's local storage: Your data does not leave your computer. It is highly recommended that you export a backup of your portfolio data using the buttons below so that your records are not lost if uninstall your browser, clear the local storage, lose your laptop, etc."]}),Object(q.jsx)("br",{}),Object(q.jsx)(Oe,{}),Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h3",children:"Parcels"}),Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h6",children:"Enter details of all holdings (past and present) below, including dividend reinvestments."}),Object(q.jsx)("br",{}),Object(q.jsx)(H,{}),Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h3",children:"Cost Base Adjustments"}),Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h6",children:"Enter details of all cost base adjustments below (e.g. AMIT net adjustments from your annual tax statements)."}),Object(q.jsx)("br",{}),Object(q.jsx)(se,{}),Object(q.jsx)("br",{}),Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h3",children:"Sales"}),Object(q.jsx)("br",{}),Object(q.jsx)(o.a,{variant:"h6",children:"Enter details of all sale events below."}),Object(q.jsx)("br",{}),Object(q.jsx)(xe,{}),Object(q.jsx)("div",{style:{height:"75vh"}})]})},Se=n(21),we=n(122);c.a.render(Object(q.jsx)(r.a.StrictMode,{children:Object(q.jsx)(Se.a,{utils:we.a,children:Object(q.jsx)(Ce,{})})}),document.getElementById("root"))}},[[160,1,2]]]);
//# sourceMappingURL=main.94296165.chunk.js.map